fi = library("filters.lib");
ba = library("basics.lib");
an = library("analyzers.lib");

f1 = fi.fir((0.1716999216395137, 0.25639564422128697, 0.09901310943151662, -0.020424859638788827, -0.09556714694704357, -0.12942603868428343, -0.13067578488424753, -0.1103029555075831, -0.07903114327456154, -0.045671986069875575, -0.016352099101338523, 0.005559255812091514, 0.019050478568438264, 0.02482270727929245, 0.024588407357252845, 0.020446614703273525, 0.014409857109778436, 0.008107434733931634, 0.0026526687660152737, -0.001360614169538179, -0.0037761366936972167, -0.004750379221813808, -0.004619883678258006, -0.00378488622632873, -0.0026225491060080357, -0.0014337077179711747, -0.00042026964298921675, 0.00031358652519647645, 0.0007447734590284556, 0.0009072144749337587, 0.0008667794450481005, 0.0006996397394656008, 0.00047637953755792317, 0.0002524652289593125, 6.443696347834395e-5, -6.95234296746669e-5, -0.00014624193672643475, -0.00017291746830585948, -0.00016239501036495915, -0.00012914499830344618, -8.635867421413556e-5, -4.424758864821229e-5, -9.409862197240204e-6, 1.5000049854703916e-5, 2.860133131124383e-5, 3.289684201767603e-5, 3.038302478606383e-5, 2.380408729925242e-5, 1.5621914593496957e-5, 7.713660553288565e-6, 1.2679406692019672e-6, -3.1716844565903968e-6, -5.573527518420117e-6, -6.247273319693471e-6, -5.6766164185218105e-6, -4.381104355266748e-6, -2.8195721309246203e-6, -1.3365581714368787e-6, -1.4564399450960825e-7, 6.602500790990188e-7, 1.0825324846043418e-6, 1.1843447137252028e-6, 1.0591380417070948e-6, 8.051167896752727e-7));

f2 = fi.fir((0.18885294286060117, 0.1794762938226889, 0.10891467414147388, -0.014297349399019499, -0.10512410657668377, -0.09059789536502039, -0.14374369828970188, -0.07721178615305963, -0.08693446015580966, -0.031970273193362625, -0.01798735092127579, 0.003891464820304411, 0.020955575250928712, 0.017375831475857084, 0.02704731111212403, 0.01431257788840144, 0.0158508797526679, 0.005675183534707582, 0.0029179424413051996, -0.0009524264314747382, -0.004153760041160596, -0.0033252532802297416, -0.005081883886668651, -0.0026494106579117425, -0.0028848107381017046, -0.00100359172804188, -0.0004622976844231276, 0.00021950976392728244, 0.0008192527137571394, 0.0006350478072976936, 0.0009534596110754144, 0.0004897460244760776, 0.0005240187122562153, 0.00017672501321281168, 7.088082497564513e-5, -4.866622258637984e-5, -0.00016086650521155932, -0.00012104178463325638, -0.00017863492761364315, -9.040116781873076e-5, -9.499476296952461e-5, -3.097319864887374e-5, -1.0350872534081142e-5, 1.0499996453739988e-5, 3.1461537746483805e-5, 2.302770509902786e-5, 3.342140513519869e-5, 1.6662800100512923e-5, 1.7184146091214775e-5, 5.3995426174854105e-6, 1.3947379858058824e-6, -2.220170990708297e-6, -6.1308945549993265e-6, -4.373075312263489e-6, -6.2442926093246655e-6, -3.0667618200842874e-6, -3.1015365704726852e-6, -9.355872944577303e-7, -1.602087672350943e-7, 4.621733631730313e-7, 1.1907885075559994e-6, 8.290382641773401e-7, 1.1650545604078015e-6, 5.635796892892792e-7));

f3 = fi.fir((0.2060059640816886, 0.10255694342409101, 0.11881623885143111, -0.008169839159250182, -0.11468106620632394, -0.05176975204575743, -0.1568116116951562, -0.044120616798536245, -0.09483777703705779, -0.018268560316849702, -0.019622602741213056, 0.0022236738285173114, 0.02286067193341916, 0.00992895567242173, 0.029506214866995208, 0.008178541073529368, 0.01729190239555736, 0.0032429323354835346, 0.003183216116595125, -0.0005442386934112984, -0.004531383388623975, -0.0019001273386456785, -0.005543884095079296, -0.0015139350894947572, -0.0031470723701953734, -0.000573475738112586, -0.0005043257258570383, 0.00012543300265808872, 0.000893731968485823, 0.0003628811396616292, 0.0010401397771027281, 0.00027985230948655496, 0.0005716578869545073, 0.000100984797466311, 7.732468647294631e-5, -2.7809015498092807e-5, -0.00017549107369668382, -6.91661009606534e-5, -0.00019487484486232712, -5.165733733401543e-5, -0.00010363085172491366, -1.7698808649535217e-5, -1.1291882870922077e-5, 5.999943052776069e-6, 3.432174418172377e-5, 1.3158568180379709e-5, 3.645978548433353e-5, 9.521512901773446e-6, 1.8746377588932587e-5, 3.0854246816822607e-6, 1.5215353024097974e-6, -1.2686575248261986e-6, -6.6882615915785355e-6, -2.4988773048335107e-6, -6.8119688001275205e-6, -1.7524192849018299e-6, -3.383501010020749e-6, -5.346164174785827e-7, -1.747735399605803e-7, 2.640966472470441e-7, 1.299044530507657e-6, 4.737318146294782e-7, 1.2709710791085079e-6, 3.220425889032861e-7));

f4 = fi.fir((0.22315898530277603, 0.025637593025492983, 0.12871780356138837, -0.002042328919480854, -0.12423802583596415, -0.012941608726494386, -0.16987952510061055, -0.011029447444012797, -0.10274109391830592, -0.004566847440336745, -0.021257854561150327, 0.0005558828367302083, 0.02476576861590961, 0.0024820798689863637, 0.03196511862186639, 0.0020445042586572804, 0.018732925038446823, 0.0008106811362594826, 0.003448489791885051, -0.00013605095534785755, -0.004909006736087354, -0.0004750013970616124, -0.006005884303489941, -0.00037845952107776974, -0.003409334002289042, -0.00014335974818329117, -0.0005463537672909492, 3.13562413888947e-5, 0.0009682112232145068, 9.071447202556413e-5, 0.001126819943130042, 6.99585944970318e-5, 0.0006192970616527994, 2.5244581719810184e-5, 8.376854797024751e-5, -6.95180840980574e-6, -0.0001901156421818084, -1.729041728805031e-5, -0.0002111147621110111, -1.2913506849299988e-5, -0.00011226694048030271, -4.424418650196667e-6, -1.2232893207763013e-5, 1.49988965181214e-6, 3.718195061696375e-5, 3.289431261731535e-6, 3.9498165833468384e-5, 2.3802257030339527e-6, 2.030860908665041e-5, 7.713067458791075e-7, 1.6483326190137124e-6, -3.1714405894409874e-7, -7.245628628157745e-6, -6.246792974035289e-7, -7.3796449909303755e-6, -4.3807674971936933e-7, -3.6654654495688138e-6, -1.3364554049943424e-7, -1.8933831268606634e-7, 6.601993132105653e-8, 1.4073005534593145e-6, 1.1842536508161555e-7, 1.3768875978092143e-6, 8.050548851729257e-8));

f5 = fi.fir((0.24031200652386342, -0.05128175737310492, 0.1386193682713456, 0.004085181320288459, -0.1337949854656043, 0.025886534592768573, -0.18294743850606487, 0.02206172191051059, -0.11064441079955403, 0.009134865436176174, -0.022893106381087592, -0.001111908155056891, 0.026670865298400053, -0.004964795934448991, 0.03442402237673757, -0.004089532556214791, 0.020173947681336284, -0.0016215700629645651, 0.003713763467174977, 0.0002721367827155823, -0.005286630083550733, 0.0009501245445224502, -0.006467884511900586, 0.0007570160473392156, -0.003671595634382711, 0.00028675624174600287, -0.0005883818087248599, -6.272051988029904e-5, 0.0010426904779431904, -0.00018145219561050026, 0.0012135001091573556, -0.00013993512049249092, 0.0006669362363510914, -5.049563402669051e-5, 9.021240946754868e-5, 1.3905398678481284e-5, -0.00020474021066693292, 3.458526638455265e-5, -0.00022735467935969505, 2.5830323635415344e-5, -0.00012090302923569175, 8.849971349141854e-6, -1.3173903544603948e-5, -3.0001637491517775e-6, 4.0042157052203715e-5, -6.579705656916613e-6, 4.2536546182603235e-5, -4.761061495705527e-6, 2.187084058436822e-5, -1.5428111899240423e-6, 1.7751299356176276e-6, 6.343694069379996e-7, -7.802995664736953e-6, 1.2495187100264494e-6, -7.947321181733231e-6, 8.76265785463088e-7, -3.947429889116878e-6, 2.6732533647971327e-7, -2.0390308541155233e-7, -1.3205678460493062e-7, 1.515556576410972e-6, -2.3688108446624632e-7, 1.4828041165099207e-6, -1.610316118687004e-7));

f6 = fi.fir((0.2574650277449509, -0.128201107771703, 0.14852093298130287, 0.01021269156005779, -0.14335194509524452, 0.06471467791203162, -0.19601535191151923, 0.055152891265034046, -0.11854772768080217, 0.022836578312689128, -0.02452835820102486, -0.002779699146843994, 0.0285759619808905, -0.012411671737884357, 0.03688292613160875, -0.010223569371086878, 0.021614970324225748, -0.004053821262188617, 0.003979037142464902, 0.0006803245207790232, -0.005664253431014112, 0.0023752504861065168, -0.0069298847203112315, 0.0018924916157562028, -0.00393385726647638, 0.0007168722316752977, -0.0006304098501587708, -0.00015679728114949306, 0.0011171697326718742, -0.0004536188632465654, 0.0013001802751846697, -0.0003498288354820141, 0.0007145754110493836, -0.00012623584977319133, 9.665627096484986e-5, 3.476260576676836e-5, -0.00021936477915205748, 8.646095005715574e-5, -0.00024359459660837905, 6.457415412013077e-5, -0.0001295391179910808, 2.2124361348480404e-5, -1.4114913881444885e-5, -7.500217150115708e-6, 4.2902363487443686e-5, -1.6448842575564785e-5, 4.5574926531738086e-5, -1.1902348694445021e-5, 2.343307208208604e-5, -3.856929125727196e-6, 1.9019272522215427e-6, 1.5858828728200997e-6, -8.360362701316163e-6, 3.1237167174564316e-6, -8.514997372536085e-6, 2.1906083206455483e-6, -4.229394328664942e-6, 6.682962134588617e-7, -2.1846785813703837e-7, -3.301335005309182e-7, 1.6238125993626297e-6, -5.92187534014109e-7, 1.5887206352106276e-6, -4.0256871225469394e-7));

f7 = fi.fir((0.27461804896603836, -0.20512045817030103, 0.15842249769126013, 0.01634020179982712, -0.15290890472488472, 0.10354282123129466, -0.20908326531697358, 0.0882440606195575, -0.1264510445620503, 0.036538291189202085, -0.02616361002096213, -0.004447490138631097, 0.03048105866338095, -0.019858547541319722, 0.03934182988647994, -0.016357606185958967, 0.023055992967115208, -0.006486072461412669, 0.0042443108177548285, 0.001088512258842464, -0.006041876778477491, 0.003800376427690583, -0.007391884928721877, 0.00302796718417319, -0.0041961188985700495, 0.0011469882216045926, -0.0006724378915926816, -0.00025087404241868705, 0.001191648987400558, -0.0007257855308826304, 0.0013868604412119836, -0.0005597225504715372, 0.0007622145857476757, -0.00020197606551969214, 0.00010310013246215104, 5.5619812855055425e-5, -0.00023398934763718205, 0.00013833663372975885, -0.00025983451385706304, 0.0001033179846048462, -0.00013817520674646986, 3.539875134781895e-5, -1.5055924218285823e-5, -1.2000270551079638e-5, 4.576256992268366e-5, -2.6317979494212957e-5, 4.8613306880872944e-5, -1.9043635893184517e-5, 2.4995303579803857e-5, -6.17104706153035e-6, 2.0287245688254577e-6, 2.5373963387021997e-6, -8.917729737895371e-6, 4.997914724886414e-6, -9.082673563338941e-6, 3.504950855828009e-6, -4.511358768213008e-6, 1.0692670904380102e-6, -2.330326308625244e-7, -5.282102164569058e-7, 1.7320686223142873e-6, -9.474939835619718e-7, 1.694637153911334e-6, -6.441058126406875e-7));

f8 = fi.fir((0.2917710701871258, -0.28203980856889893, 0.16832406240121736, 0.022467712039596435, -0.1624658643545249, 0.14237096455055762, -0.2221511787224279, 0.12133522997408089, -0.13435436144329843, 0.050240004065715, -0.027798861840899393, -0.0061152811304181955, 0.032386155345871394, -0.027305423344755077, 0.04180073364135112, -0.022491643000831035, 0.02449701561000467, -0.008918323660636716, 0.004509584493044754, 0.0014966999969059037, -0.00641950012594087, 0.0052255023692746455, -0.00785388513713252, 0.004163442752590176, -0.0044583805306637175, 0.0015771042115338863, -0.0007144659330265925, -0.00034495080368788085, 0.0012661282421292416, -0.0009979521985186948, 0.0014735406072392972, -0.00076961626546106, 0.0008098537604459676, -0.00027771628126619285, 0.00010954399395945222, 7.647701994334245e-5, -0.00024861391612230656, 0.00019021231740236181, -0.000276074431105747, 0.00014206181508956154, -0.0001468112955018589, 4.8673141347157475e-5, -1.5996934555126758e-5, -1.6500323952043557e-5, 4.8622776357923624e-5, -3.6187116412861106e-5, 5.165168723000779e-5, -2.6184923091923993e-5, 2.655753507752167e-5, -8.485164997333499e-6, 2.155521885429373e-6, 3.488909804584298e-6, -9.475096774474581e-6, 6.872112732316391e-6, -9.650349754141795e-6, 4.819293391010466e-6, -4.793323207761071e-6, 1.4702379674171575e-6, -2.4759740358801045e-7, -7.26286932382893e-7, 1.840324645265945e-6, -1.3028004331098337e-6, 1.8005536726120404e-6, -8.856429130266805e-7));

f9 = fi.fir((0.30892409140821325, -0.35895915896749697, 0.17822562711117462, 0.028595222279365763, -0.1720228239841651, 0.18119910786982066, -0.23521909212788225, 0.15442639932860433, -0.14225767832454655, 0.06394171694222794, -0.029434113660836664, -0.007783072122205299, 0.03429125202836184, -0.034752299148190446, 0.044259637396222296, -0.02862567981570312, 0.025938038252894133, -0.01135057485986077, 0.004774858168334679, 0.0019048877349693446, -0.006797123473404249, 0.0066506283108587125, -0.008315885345543166, 0.005298918321007163, -0.004720642162757387, 0.0020072202014631813, -0.0007564939744605032, -0.00043902756495707487, 0.0013406074968579254, -0.0012701188661547599, 0.0015602207732666113, -0.000979509980450583, 0.0008574929351442597, -0.0003534564970126937, 0.00011598785545675341, 9.733422703162954e-5, -0.0002632384846074311, 0.0002420880010749649, -0.000292314348354431, 0.00018080564557427695, -0.00015544738425724795, 6.194753134649603e-5, -1.6937944891967696e-5, -2.1000377353007483e-5, 5.14829827931636e-5, -4.605625333150928e-5, 5.4690067579142647e-5, -3.332621029066349e-5, 2.8119766575239487e-5, -1.0799282933136654e-5, 2.282319202033288e-6, 4.440423270466397e-6, -1.0032463811053791e-5, 8.746310739746374e-6, -1.0218025944944651e-5, 6.133635926192926e-6, -5.075287647309136e-6, 1.871208844396306e-6, -2.621621763134965e-7, -9.243636483088805e-7, 1.9485806682176024e-6, -1.6581068826576963e-6, 1.906470191312747e-6, -1.127180013412674e-6));

f10 = fi.fir((0.3260771126293006, -0.4358785093660949, 0.18812719182113186, 0.03472273251913508, -0.18157978361380525, 0.22002725118908362, -0.24828700553333657, 0.18751756868312772, -0.15016099520579468, 0.07764342981874088, -0.031069365480773926, -0.009450863113992397, 0.03619634871085228, -0.0421991749516258, 0.04671854115109347, -0.03475971663057519, 0.027379060895783593, -0.013782826059084817, 0.005040131843624605, 0.0023130754730327843, -0.007174746820867627, 0.008075754252442776, -0.00877788555395381, 0.006434393889424148, -0.004982903794851056, 0.0024373361913924752, -0.0007985220158944139, -0.0005331043262262686, 0.001415086751586609, -0.0015422855337908245, 0.001646900939293925, -0.0011894036954401058, 0.0009051321098425518, -0.00042919671275919435, 0.00012243171695405458, 0.00011819143411991655, -0.0002778630530925556, 0.00029396368474756784, -0.0003085542656031149, 0.00021954947605899228, -0.000164083473012637, 7.522192134583455e-5, -1.787895522880863e-5, -2.5500430753971402e-5, 5.434318922840357e-5, -5.592539025015743e-5, 5.772844792827749e-5, -4.046749748940297e-5, 2.9681998072957302e-5, -1.3113400868939803e-5, 2.409116518637203e-6, 5.391936736348496e-6, -1.0589830847633e-5, 1.0620508747176351e-5, -1.0785702135747505e-5, 7.447978461375384e-6, -5.3572520868572e-6, 2.2721797213754538e-6, -2.767269490389825e-7, -1.1224403642348676e-6, 2.05683669116926e-6, -2.0134133322055585e-6, 2.0123867100134537e-6, -1.368717113798667e-6));

f11 = fi.fir((0.3432301338503881, -0.5127978597646929, 0.19802875653108912, 0.040850242758904406, -0.19113674324344546, 0.25885539450834666, -0.2613549189387909, 0.2206087380376512, -0.1580643120870428, 0.09134514269525383, -0.0327046173007112, -0.011118654105779502, 0.03810144539334274, -0.049646050755061163, 0.04917744490596466, -0.04089375344544728, 0.028820083538673057, -0.01621507725830887, 0.005305405518914531, 0.0027212632110962254, -0.007552370168331007, 0.009500880194026841, -0.009239885762364456, 0.007569869457841136, -0.005245165426944725, 0.00286745218132177, -0.0008405500573283248, -0.0006271810874954626, 0.0014895660063152928, -0.0018144522014268895, 0.0017335811053212388, -0.001399297410429629, 0.000952771284540844, -0.0005049369285056952, 0.00012887557845135577, 0.00013904864120820363, -0.0002924876215776802, 0.00034583936842017096, -0.0003247941828517989, 0.0002582933065437077, -0.00017271956176802606, 8.84963113451731e-5, -1.8819965565649568e-5, -3.000048415493533e-5, 5.720339566364354e-5, -6.57945271688056e-5, 6.076682827741235e-5, -4.760878468814246e-5, 3.124422957067512e-5, -1.5427518804742957e-5, 2.535913835241118e-6, 6.343450202230596e-6, -1.1147197884212209e-5, 1.2494706754606334e-5, -1.1353378326550361e-5, 8.762320996557844e-6, -5.639216526405265e-6, 2.673150598354602e-6, -2.912917217644685e-7, -1.3205170801608552e-6, 2.1650927141209176e-6, -2.368719781753421e-6, 2.11830322871416e-6, -1.6102542141846606e-6));

selector(x, s) = x <: *(f1, (s >= 0.0) & (s < 0.1)), *(f2, (s >= 0.1) & (s < 0.2)), *(f3, (s >= 0.2) & (s < 0.3)), *(f4, (s >= 0.3) & (s < 0.4)), *(f5, (s >= 0.4) & (s < 0.5)), *(f6, (s >= 0.5) & (s < 0.6)), *(f7, (s >= 0.6) & (s < 0.7)), *(f8, (s >= 0.7) & (s < 0.8)), *(f9, (s >= 0.8) & (s < 0.9)), *(f10, (s >= 0.9) & (s < 1.0)), *(f11, (s >= 1.0)) :> _;

env = an.amp_follower(rel)
with{
    rel = hslider("[1]Release [unit:ms][style:knob]", 5, 1, 1000, 0.1) * 0.001;
};

process = _ <: _, env : selector;